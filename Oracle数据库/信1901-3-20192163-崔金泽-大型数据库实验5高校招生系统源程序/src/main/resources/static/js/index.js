function loadCollegeList(){gridTable.jsGrid({height:"500px",width:"100%",filtering:!0,sorting:!0,autoload:!0,noDataContent:"没有数据！",controller:{loadData:function(){var e=$.Deferred();return $.ajax({type:"GET",url:serverURL+"/college",dataType:"json"}).done(function(t){e.resolve(t)}),e.promise()}},onDataLoaded:function(){gridTable.jsGrid("sort",0,"asc")},rowClick:function(e){loadCollegeEnrollList(e.item.number)},fields:[{name:"number",type:"number",width:50,align:"center",title:"学校代码"},{name:"name",type:"text",width:150,align:"center",title:"学校名称"},{name:"borderline",type:"number",width:50,align:"center",title:"最低录取分数线"},{name:"targetEnroll",type:"number",width:50,align:"center",title:"控制录取数"}]})}function loadEnrollReport(){gridTable.jsGrid({height:"500px",width:"100%",sorting:!0,autoload:!0,controller:{loadData:function(){var e=$.Deferred();return $.ajax({type:"GET",url:serverURL+"/college/enrollreport",dataType:"json"}).done(function(t){e.resolve(t)}),e.promise()}},onDataLoaded:function(){gridTable.jsGrid("sort",0,"asc")},rowClick:function(e){loadCollegeEnrollList(e.item.number)},fields:[{name:"number",type:"number",width:50,align:"center",title:"学校代码"},{name:"name",type:"text",width:150,align:"center",title:"学校名称"},{name:"actualEnroll",type:"number",width:50,align:"center",title:"实际录取数"},{name:"vacancies",type:"number",width:50,align:"center",title:"缺档数"}]})}function loadCollegeEnrollList(e){gridTable.jsGrid({height:"500px",width:"100%",sorting:!0,autoload:!0,controller:{loadData:function(){var t=$.Deferred();return $.ajax({type:"GET",url:serverURL+"/college/"+e+"/enrolllist",dataType:"json"}).done(function(e){t.resolve(e)}),t.promise()}},onDataLoaded:function(){gridTable.jsGrid("sort",0,"asc")},rowClick:$.noop,fields:[{name:"number",type:"number",width:50,align:"center",title:"录取考生考号"},{name:"name",type:"text",width:150,align:"center",title:"录取考生姓名"}]})}function loadStudentList(){gridTable.jsGrid({height:"500px",width:"100%",filtering:!0,sorting:!0,autoload:!0,controller:{loadData:function(){var e=$.Deferred();return $.ajax({type:"GET",url:serverURL+"/student",dataType:"json"}).done(function(t){e.resolve(t)}),e.promise()}},onDataLoaded:function(){gridTable.jsGrid("sort",0,"asc")},rowClick:$.noop,fields:[{name:"number",type:"number",width:50,align:"center",title:"考生考号"},{name:"name",type:"text",width:150,align:"center",title:"考生姓名"},{name:"gender",type:"text",width:50,align:"center",title:"性别"},{name:"grade",type:"number",width:50,align:"center",title:"高考总分"},{type:"control",width:80,clearFilterButton:!0,modeSwitchButton:!1,itemTemplate:function(e,t){return $("<div>").append($("<a>").text("考生志愿").attr("href","javascript:loadStudentOneWill("+t.number+")")).append($("<span>").text("    ")).append($("<a>").text("录取学校").attr("href","javascript:loadStudentOneEnroll("+t.number+")"))}}]})}function loadStudentOneWill(e){var t={};$.ajax({type:"GET",url:serverURL+"/student/"+e+"/will",dataType:"json"}).done(function(e){t=e,t["aspiration1-number"]=t.aspiration1.number,t["aspiration1-name"]=t.aspiration1.name,t["aspiration2-number"]=t.aspiration2.number,t["aspiration2-name"]=t.aspiration2.name,gridTable.jsGrid({height:"500px",width:"100%",filtering:!1,sorting:!0,autoload:!1,data:[t],controller:{loadData:$.noop},onDataLoaded:$.noop,rowClick:$.noop,fields:[{name:"number",type:"number",width:50,align:"center",title:"考生考号"},{name:"aspiration1-number",type:"number",width:50,align:"center",title:"志愿1 - 学校代码"},{name:"aspiration1-name",type:"text",width:50,align:"center",title:"志愿1 - 学校名称"},{name:"aspiration2-number",type:"number",width:50,align:"center",title:"志愿2 - 学校代码"},{name:"aspiration2-name",type:"text",width:50,align:"center",title:"志愿2 - 学校名称"},{name:"autoAdjust",type:"checkbox",width:50,sorter:"number",align:"center",autosearch:!0,title:"是否服从分配"}]})})}function loadStudentOneEnroll(e){gridTable.jsGrid({height:"500px",width:"100%",filtering:!1,sorting:!0,autoload:!0,controller:{loadData:function(){var t=$.Deferred();return $.ajax({type:"GET",url:serverURL+"/student/"+e+"/enrollcollege",dataType:"json"}).done(function(e){t.resolve([e])}),t.promise()}},onDataLoaded:$.noop,rowClick:$.noop,fields:[{name:"number",type:"number",width:50,align:"center",title:"录取学校代码"},{name:"name",type:"text",width:150,align:"center",title:"录取学校名称"}]})}var serverURL="",gridTable=null;$(function(){$("#enrollManipulator").modal({show:!1}),$("#enrollManipulatorSubmit").click(function(){$.post({type:"POST",url:serverURL+"/enrollmanipulator",data:$("#enrollManipulatorForm").serialize(),complete:function(e,t){alert(t),location.reload(!1)}}),$("#enrollManipulator").modal("hide")}),gridTable=$("#jsGrid"),loadCollegeList()});